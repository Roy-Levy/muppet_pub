<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>IRT Calibration, In-Sample Scoring, &amp; Out-Of-Sample Scoring, in 3 Fragments • muppet</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.7/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.0/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.0/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="IRT Calibration, In-Sample Scoring, &amp; Out-Of-Sample Scoring, in 3 Fragments">
<style>
.pkgdown-footer-left { display: none; }
</style>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">muppet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Examples and Tips</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>IRT Calibration, In-Sample Scoring, &amp; Out-Of-Sample Scoring, in 3 Fragments</h1>
            
            <h4 data-toc-skip class="date">2025-08-29</h4>
      

      <div class="d-none name"><code>example_3.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This example demonstrates how to use the muppet() package to perform
MUPPET modeling for an item response theory (IRT) example. The example
has 3 fragments. In Fragment 1 (calibration), the measurement model is
fit to a set of item responses for 10 items from a sample of examinees
(referred to as Sample A). Fitting this fragment yields estimated
measurement model (i.e., item) parameters. In Fragment 2, the results
from Fragment 1 are used to estimate latent variable values for the
examinees from this same dataset, Sample A (i.e., conduct in-sample
scoring). In Fragment 3, the results from Fragment 1 are used to
estimate latent variable values of for a different set of examinees
(Sample B) whose data were not part of the calibration process (i.e.,
conduct out-of-sample scoring).</p>
</div>
<div class="section level2">
<h2 id="data-prepration">Data Prepration<a class="anchor" aria-label="anchor" href="#data-prepration"></a>
</h2>
<p>Load the package and extract the data for this example.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://roy-levy.github.io/muppet_pub/">muppet</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sim.IRT</span>, package <span class="op">=</span> <span class="st">"muppet"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="specify-fragment-1">Specify Fragment 1<a class="anchor" aria-label="anchor" href="#specify-fragment-1"></a>
</h2>
<p>Fragment 1 fits an IRT model to item responses to 10 items. One key
specification for Fragment 1 is the Mplus syntax for the IRT measurement
model. In this specification the latent variable is modeled as having a
fixed mean and variance. All the loadings (discriminations) and location
parameters are estimated.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Mplus.MODEL.syntax.fragment.1</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">  F1 by It1-It10*;</span></span>
<span><span class="st">  [It1$1-It10$1];</span></span>
<span><span class="st">  F1@1;</span></span>
<span><span class="st">  [F1@0];</span></span>
<span><span class="st">"</span></span></code></pre></div>
<p>As the observed variables are discrete (categorical), we will need to
specify them as such for the Mplus VARIABLE command. To do so, define an
R object with the desired text for the Mplus input file.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Mplus.VARIABLE.syntax.fragment.1</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">     CATEGORICAL =</span></span>
<span><span class="st">        It1-It10</span></span>
<span><span class="st">    ;</span></span>
<span><span class="st">  "</span></span></code></pre></div>
<p>Now define the specifications for the fragment. In this list we are
passing along the syntax from above. By setting
<code>conditioning = 0</code> in this list of specifications, we are
fitting this fragment without conditioning on any other fragment. The
data argument selects the relevant item responses from the raw dataset,
namely those from Sample A responding to items 1-10.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">fragment.1.specs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"Sample A Items 1-10 Calibration"</span>,</span>
<span>  model.syntax <span class="op">=</span> <span class="va">Mplus.MODEL.syntax.fragment.1</span>,</span>
<span>  variable.syntax <span class="op">=</span> <span class="va">Mplus.VARIABLE.syntax.fragment.1</span>,</span>
<span>  conditioning <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  data <span class="op">=</span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="va">sim.IRT.data.sample.A</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"ID"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="va">sim.IRT.data.sample.A</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">num_range</a></span><span class="op">(</span><span class="st">"It"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="specify-fragment-2">Specify Fragment 2<a class="anchor" aria-label="anchor" href="#specify-fragment-2"></a>
</h2>
<p>In Fragment 2 we wish to estimate the latent variables for the
examinees from Fragment 1. So our model is the same as it was in
Fragment 1. The model syntax just includes the model specifications for
the latent variable mean and variance. These were included in Fragment 1
as well, but also need to be here to preserve this constraint. In
effect, the function will bring in the results for the <em>fitted</em>
parameters from Fragment 1. But the latent variable mean and variance
were not fitted parameters in Fragment 1. They were fixed in Fragment 1.
So they will not be “brought forward” by looking at the fitted results
from Fragment 1. So they need to be specified here as well.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Mplus.MODEL.syntax.fragment.2</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">  F1@1;</span></span>
<span><span class="st">  [F1@0];</span></span>
<span><span class="st">"</span></span></code></pre></div>
<p>As in Fragment 1, we need to communicate that the observed variables
are discrete (categorical). To do so, we can simply define an R object
with the desired text for the Mplus input file as being just as it was
in Fragment 1.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Mplus.VARIABLE.syntax.fragment.2</span> <span class="op">&lt;-</span> <span class="va">Mplus.VARIABLE.syntax.fragment.1</span></span></code></pre></div>
<p>Now define the specifications for the fragment. In this list we are
passing along the syntax from above. By setting
<code>conditioning = 1</code> in this list of specifications, we are
fitting this fragment conditional on Fragment 1. We declare that this
fragment involves estimating latent variables by setting
<code>estimating.lvs = TRUE</code>. In the next argument, we give the
text for the names of the latent variables to be estimated. This name
must correpond to the name in the Mplus syntax. In this case, the name
of the latent variable in Mplus is <code>F1</code>, so we indicate that
<code>lvs.to.estimate = c("F1")</code>. The data are the same data as in
Fragment 1. We are using the same dataset in both fragments; here in
Fragment 2 we are estimating the latent variables for the same examinees
that were used in Fragment 1. That is, we are conducting in-sample
scoring conditional on the calibration in Fragment 1.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">fragment.2.specs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span><span class="st">"Sample A Items 1-10 Scoring"</span>,</span>
<span>  model.syntax <span class="op">=</span> <span class="va">Mplus.MODEL.syntax.fragment.2</span>,</span>
<span>  variable.syntax <span class="op">=</span> <span class="va">Mplus.VARIABLE.syntax.fragment.2</span>,</span>
<span>  conditioning <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  estimating.lvs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  lvs.to.estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"F1"</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="va">sim.IRT.data.sample.A</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"ID"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="va">sim.IRT.data.sample.A</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">num_range</a></span><span class="op">(</span><span class="st">"It"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="specify-fragment-3">Specify Fragment 3<a class="anchor" aria-label="anchor" href="#specify-fragment-3"></a>
</h2>
<p>Fragment 3 is like Fragment 2 in that we wish to estimate the latent
variables for examinees. The difference is that these examinees are not
the same as those used in Fragment 1 (i.e., Fragment 3 pursues
out-of-sample scoring. The model is the same as it was in Fragments 1
and 2. Like the syntax for Fragmen 2, the model syntax here just
includes the model specifications for the latent variable mean and
variance. These were included in Fragment 1 as well, but as discussed
above also need to be here to preserve this constraint.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Mplus.MODEL.syntax.fragment.3</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">  F1@1;</span></span>
<span><span class="st">  [F1@0];</span></span>
<span><span class="st">"</span></span></code></pre></div>
<p>Once again we need to communicate that the observed variables are
discrete (categorical). To do so, we can simply define an R object with
the desired text for the Mplus input file as being just as it was in
Fragment 2.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Mplus.VARIABLE.syntax.fragment.3</span> <span class="op">&lt;-</span> <span class="va">Mplus.VARIABLE.syntax.fragment.2</span></span></code></pre></div>
<p>Now define the specifications for the fragment. These specifications
mimic those for Fragment 2. The key difference is in the data. Here we
are using the item responses from a different sample (Sample B) than
used in the previous fragment. Note also that by setting
<code>conditioning = 1</code> in this list of specifications, we are
fitting this fragment conditional on Fragment 1, but not conditional on
Fragment 2.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">fragment.3.specs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span><span class="st">"Sample B Items 1-10 Scoring"</span>,</span>
<span>  model.syntax <span class="op">=</span> <span class="va">Mplus.MODEL.syntax.fragment.3</span>,</span>
<span>  variable.syntax <span class="op">=</span> <span class="va">Mplus.VARIABLE.syntax.fragment.3</span>,</span>
<span>  conditioning <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  estimating.lvs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  lvs.to.estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"F1"</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="va">sim.IRT.data.sample.B</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"ID"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="va">sim.IRT.data.sample.B</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">num_range</a></span><span class="op">(</span><span class="st">"It"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="conduct-muppet-modeling">Conduct MUPPET modeling<a class="anchor" aria-label="anchor" href="#conduct-muppet-modeling"></a>
</h2>
<p>The code below demonstrates conducting MUPPET modeling. The
<code>fragments</code> argument contains the specifications for the
model fragments defined above. The rest of the arguments communicate
specifications for running MCMC and saving output. Running this code
will write out output files.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/MUPPET.modular.html">MUPPET.modular</a></span><span class="op">(</span></span>
<span>    fragments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fragment.1.specs</span>, <span class="va">fragment.2.specs</span>, <span class="va">fragment.3.specs</span><span class="op">)</span>,</span>
<span>    n.chains <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    n.warmup <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    n.burnin <span class="op">=</span> <span class="fl">500</span>,</span>
<span>    n.iters.per.chain.after.warmup.and.burnin <span class="op">=</span> <span class="fl">100</span>,</span>
<span>    n.estimation.batches <span class="op">=</span> <span class="fl">25</span>,</span>
<span>    convergence.assessment <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>    save.summary.plots.from.MUPPET <span class="op">=</span> <span class="st">"none"</span>,</span>
<span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Roy Levy.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
